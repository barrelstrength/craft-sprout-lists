{% extends "sprout-lists/_layouts/base" %}
{% import "_includes/forms" as forms %}

{% set title = "Edit List"|t %}

{% if craft.request.getSegment(3) == 'new' %}
    {% set title = "New List"|t %}
{% endif %}

{% set crumbs = [
    { label: "Lists"|t, url: url('sproutlists/lists') },
] %}

{% set fullPageForm = true %}

{% block actionButton %}
    <div class="btngroup submit first">
        <input type="submit" class="btn submit" value="{{ 'Save List'|t }}">
    </div>
{% endblock %}

{% set saveShortcutRedirect = continueEditingUrl %}

{% block content %}

    <div class="grid">
        <div class="item" data-position="left" data-min-colspan="2"
             data-max-cols="3">
            <div class="pane">
                <input type="hidden" name="action"
                       value="sprout-lists/lists/save-list">
                {{ redirectInput("sprout-lists/lists") }}

                <input type="hidden" name="listId"
                       value="{{ list.id is defined ? list.id : null }}">
                <input type="hidden"
                       name="type"
                       value="barrelstrength\sproutlists\integrations\sproutlists\SubscriberListType">

                {{ forms.textField({
                    label: "List Name"|t,
                    instructions: "The name of your list that will be visible to users."|t,
                    id: 'name',
                    name: 'name',
                    value: (list is defined ? list.name : null),
                    autofocus: true,
                    required: true,
                    first: true,
                    errors: (list is defined ? list.getErrors('name') : null)
                }) }}

                {{ forms.textField({
                    label: "List Handle"|t,
                    instructions: "How youâ€™ll refer to this list in your templates."|t,
                    id: 'handle',
                    name: 'handle',
                    value: (list is defined ? list.handle : null),
                required: true,
                errors: (list is defined ? list.getErrors('handle') : null)
                }) }}

            </div>
        </div>

        {% if list.id is not null %}
            <div class="item" data-position="right" data-colspan="1">
                <div class="pane meta">

                    <div class="field">
                        <div class="heading">
                            <label>{{ "List Type"|t }}</label>
                        </div>
                        <div class="input">
                            <h6>{{ "Recipients"|t }}</h6>
                        </div>
                    </div>

                    {% set statusInput %}
                        <div class="right">
                            <input
                                    type="button"
                                    class="btn small formsubmit"
                                    data-action="sprout-lists/lists/delete-list"
                                    data-confirm="{{ 'Are you sure you want to delete this list?'|t }}"
                                    data-redirect="sprout-lists/lists"
                                    value="{{ 'Delete'|t }}">
                        </div>
                    {% endset %}

                    {{ forms.field({
                        label: '<span class="info">Deleting a List will delete all Subscriptions to the List. No Subscribers will be deleted.</span>'|t,
                    }, statusInput) }}

                </div>

                {% if list.dateCreated is not null %}
                    <div class="pane lightpane meta">
                        <div class="data">
                            <h5 class="heading">{{ "Date Created"|t }}</h5>
                            <div class="value">{{ list.dateCreated.localeDate() }} {{ list.dateCreated.localeTime() }}</div>
                        </div>
                        <div class="data">
                            <h5 class="heading">{{ "Date Updated"|t }}</h5>
                            <div class="value">{{ list.dateUpdated.localeDate() }} {{ list.dateUpdated.localeTime() }}</div>
                        </div>
                    </div>
                {% endif %}
            </div>
        {% endif %}

    </div>

{% endblock %}

{% if not list.handle %}
    {% includejs %}
        new Craft.HandleGenerator('#name', '#handle');
    {% endincludejs %}
{% endif %}
